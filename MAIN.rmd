---
title: "Project"
output: html_document
---

```{r eval=TRUE, include=FALSE}
library(tidyverse)
#install.packages("gtrendsR")
library(gtrendsR)
#library("docstring")
source("project_utils.R")

```

```{=html}
<style>
    p  {direction: rtl;}
    h1 {text-align: center;}
    h2 {direction: rtl;}
    h4 {direction: rtl;}
    h3 {direction: rtl;text-decoration: underline;}
    ol {direction: rtl;}
    li {direction: rtl;}
</style>
```
<h1><u>מגישים</u></h1>

::: {style="border-bottom:solid"}
:::

```{r}
fmt <- "%Y-%m-%d"

data <- get_data() # the main dataset, contains ads info
rating <- get_rating_data() # contains rating info, e.g., ads cost, viewrs and etc
general <- get_general_data() # ads categories, e.g., beer, car and etc 
```

```{r}
brands = unique(data['brand'])
brand_q <- data %>%
  group_by(brand) %>%
  summarise(count = n())

ggplot(data=brand_q, aes(x=brand, y=count))+
  geom_bar(stat = 'identity')

```

```{r}
brand = "Coca-Cola"
dates = search_dates(brand)
dates
```

```{r}

day = dates[10,]
month_q = paste(day - 5, day + 5)
#month_trands <- gtrends(c('doritos', 'Doritos'), geo = "US", time=month_q)


#plot(month_trands)
#plot(gtrends(c(brand, 'Doritos', 'Pepsi'), geo = "US", time=month_q))
```

```{r}

hits = month_trands$interest_over_time$hits
date = month_trands$interest_over_time$date


ggplot(month_trands$interest_over_time, aes(x=date ,y=hits, colour=keyword)) +
  geom_line() +
  geom_vline(xintercept=date[3],linetype = "dashed")


```

```{r}
by_year <- filter(data, year == 2012) %>% .$brand
by_year
d<- filter(data, year == 2012)

```

```{r}

gtrends_plot(brands=c('Pepsi', 'Coca-cola'), day, rday=2)
```
